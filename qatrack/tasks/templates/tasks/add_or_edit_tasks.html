{% extends "site_base.html" %}

{% load staticfiles %}
{% load crispy_forms_tags %}

{% block head_title %}Add/edit or perform task{% endblock %}

{% block body %}
    <p>
        <a class="btn btn-primary" type="button" href="{% url tasks_overview %}">Tasks overview</a>
    </p>
    {% if not can_edit %}
        <p>
        <dl class="dl-horizontal">
            <dt>Name</dt>
            <dd>{{ task.name }}</dd>
            <dt>Category</dt>
            <dd>{{ task.category }}</dd>
            <dt>Unit</dt>
            <dd>{{ task.unit }}</dd>
            <dt>Due date</dt>
            <dd>{{ task.due_date }}</dd>
            <dt>Overdue date</dt>
            <dd>{{ task.overdue_date }}</dd>
            <dt>Users edit</dt>
            <dd>
                {% for user in task.list_edit_users %}
                    {{ user }}
                {% endfor %}
            </dd>
            <dt>Groups edit</dt>
            <dd>
                {% for group in task.list_edit_groups %}
                    {{ group }}
                {% endfor %}
            </dd>
            <dt>Users perform</dt>
            <dd>
                {% for user in task.list_perform_users %}
                    {{ user }}
                {% endfor %}
            </dd>
            <dt>Groups perform</dt>
            <dd>
                {% for group in task.list_perform_groups %}
                    {{ group }}
                {% endfor %}
            </dd>
        </dl>
        </p>
    {% endif %}<br>

    <p>
    {% crispy form %}
    </p>

    {# datetimepicker #}
    <link rel="stylesheet" type="text/css" href="{% static "datetimepicker/jquery.datetimepicker.css" %}"/>
    <script src="{% static "datetimepicker/jquery.datetimepicker.js" %}"></script>
    {# bootstrap multiselect #}
    <script type="text/javascript" src="{% static "bootstrap-multiselect-master/js/bootstrap-multiselect.js" %}"></script>
    <link rel="stylesheet" href="{% static "bootstrap-multiselect-master/css/bootstrap-multiselect.css"  %}" type="text/css"/>
    {# readonly #}
    <script type="text/javascript" src="{% static "readonly/readonly.js" %}"></script>


    <script type='text/javascript'>
        $(document).ready(function() {
            $('.selectmultiple').multiselect({
                enableFiltering: true
            });

            var can_edit = '{{ can_edit }}';
            var can_perform = '{{ can_perform }}';

            if (can_edit == 'True') {
                $('#id_due_date, #id_overdue_date').datetimepicker({
                    timepicker:false,
                    format:'Y-m-d'
                });
            }

            if (can_edit == 'False') {
                $("#id_status option[value='Reviewed']").remove();
            }
        });
    </script>

{% endblock %}